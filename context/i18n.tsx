import React, { createContext, useState, useContext, useEffect, useCallback } from 'react';

const arTranslations = {
  "sidebar.dashboard": "لوحة التحكم",
  "sidebar.tenants": "إدارة الشركات",
  "sidebar.tenants.all": "كل الشركات",
  "sidebar.subscriptions": "الاشتراكات والفوترة",
  "sidebar.paymentGateways": "بوابات الدفع",
  "sidebar.reports": "التقارير",
  "sidebar.communication": "التواصل",
  "sidebar.settings": "إعدادات النظام",
  "sidebar.logout": "تسجيل الخروج",
  "header.superAdmin": "مدير النظام",
  "header.changePassword": "تغيير كلمة المرور",
  "dashboard.title": "لوحة التحكم الرئيسية",
  "dashboard.kpi.mrr": "إجمالي الإيرادات الشهرية (MRR)",
  "dashboard.kpi.activeTenants": "إجمالي الشركات النشطة",
  "dashboard.kpi.newSubscriptions": "اشتراكات جديدة (30 يوم)",
  "dashboard.kpi.expiringSubscriptions": "اشتراكات ستنتهي (7 أيام)",
  "dashboard.revenueGrowth.title": "نمو الإيرادات (آخر 12 شهرًا)",
  "dashboard.revenueGrowth.revenue": "الإيرادات",
  "dashboard.revenueGrowth.profit": "الأرباح",
  "dashboard.planDistribution.title": "توزيع الشركات على الخطط",
  "dashboard.planDistribution.tenants": "عدد الشركات",
  "dashboard.recentCompanies.title": "آخر 5 شركات قامت بالتسجيل",
  "dashboard.recentPayments.title": "آخر 5 عمليات دفع ناجحة",
  "tenants.title": "إدارة الشركات (Tenants)",
  "tenants.searchPlaceholder": "بحث بالاسم أو النطاق...",
  "tenants.filterByPlan": "فلترة حسب الخطة",
  "tenants.filterByStatus": "فلترة حسب الحالة",
  "tenants.table.companyName": "اسم الشركة",
  "tenants.table.subdomain": "النطاق المخصص",
  "tenants.table.currentPlan": "الخطة الحالية",
  "tenants.table.status": "الحالة",
  "tenants.table.startDate": "تاريخ البدء",
  "tenants.table.endDate": "تاريخ الانتهاء",
  "tenants.table.users": "المستخدمون",
  "tenants.table.actions": "إجراءات",
  "tenants.actions.view": "عرض التفاصيل",
  "tenants.actions.edit": "تعديل الشركة",
  "tenants.actions.activate": "تفعيل الحساب",
  "tenants.actions.deactivate": "تعطيل الحساب",
  "tenants.modal.viewTitle": "تفاصيل الشركة",
  "tenants.modal.editTitle": "تعديل بيانات الشركة",
  "tenants.modal.close": "إغلاق",
  "tenants.modal.save": "حفظ التغييرات",
  "tenants.add.button": "إضافة شركة جديدة",
  "tenants.add.title": "إنشاء حساب شركة جديدة",
  "tenants.add.companyNamePlaceholder": "مثال: شركة الأمل التجارية",
  "tenants.add.subdomainPlaceholder": "مثال: alamal",
  "tenants.add.adminName": "اسم مدير الحساب",
  "tenants.add.adminNamePlaceholder": "مثال: أحمد علي",
  "tenants.add.adminEmail": "البريد الإلكتروني للمدير",
  "tenants.add.adminEmailPlaceholder": "مثال: admin@alamal.com",
  "tenants.add.password": "كلمة المرور الأولية",
  "tenants.add.generate": "توليد",
  "tenants.add.subdomainTaken": "هذا النطاق مستخدم بالفعل. الرجاء اختيار نطاق آخر.",
  "status.Active": "نشط",
  "status.Trial": "تجريبي",
  "status.Expired": "منتهي",
  "status.Deactivated": "معطل",
  "status.Disabled": "معطل",
  "status.SetupRequired": "يتطلب إعداد",
  "subscriptions.title": "الاشتراكات والفوترة",
  "subscriptions.tabs.plans": "خطط الأسعار",
  "subscriptions.tabs.payments": "سجل المدفوعات",
  "subscriptions.tabs.invoices": "الفواتير",
  "subscriptions.plans.createPlan": "إنشاء خطة جديدة",
  "subscriptions.plans.editPlan": "تعديل الخطة",
  "subscriptions.plans.deletePlan": "حذف الخطة",
  "subscriptions.plans.deleteDisabledTooltip": "لا يمكن حذف خطة لديها مشتركين حاليين.",
  "subscriptions.plans.createTitle": "إنشاء خطة جديدة",
  "subscriptions.plans.editTitle": "تعديل الخطة",
  "subscriptions.plans.planName": "اسم الخطة",
  "subscriptions.plans.planType": "نوع الخطة",
  "subscriptions.plans.type.Trial": "تجريبية",
  "subscriptions.plans.type.Paid": "مدفوعة",
  "subscriptions.plans.type.Free": "مجانية",
  "subscriptions.plans.trialDuration": "مدة التجربة",
  "subscriptions.plans.days": "أيام",
  "subscriptions.plans.pricing": "التسعير",
  "subscriptions.plans.priceMonthly": "السعر الشهري ($)",
  "subscriptions.plans.priceYearly": "السعر السنوي ($)",
  "subscriptions.plans.yearlyDiscount": "مثال: عرض شهرين مجانًا",
  "subscriptions.plans.resourceLimits": "حدود الموارد",
  "subscriptions.plans.maxUsers": "الحد الأقصى للمستخدمين",
  "subscriptions.plans.unlimited": "غير محدود",
  "subscriptions.plans.maxClients": "الحد الأقصى للعملاء",
  "subscriptions.plans.clients": "عملاء",
  "subscriptions.plans.storageGB": "مساحة التخزين (GB)",
  "subscriptions.plans.features": "قائمة الميزات",
  "subscriptions.plans.featuresPlaceholder": "أدخل ميزة واحدة في كل سطر...",
  "subscriptions.plans.users": "مستخدمين",
  "subscriptions.plans.storage": "سعة تخزين",
  "subscriptions.plans.edit": "تعديل",
  "subscriptions.plans.show": "مرئية للمستخدمين الجدد",
  "subscriptions.payments.export": "تصدير",
  "subscriptions.payments.table.transactionId": "معرّف العملية",
  "subscriptions.payments.table.companyName": "اسم الشركة",
  "subscriptions.payments.table.amount": "المبلغ",
  "subscriptions.payments.table.status": "الحالة",
  "subscriptions.payments.table.date": "التاريخ",
  "status.Successful": "ناجح",
  "status.Failed": "فاشل",
  "subscriptions.invoices.table.invoiceNo": "رقم الفاتورة",
  "subscriptions.invoices.table.companyName": "اسم الشركة",
  "subscriptions.invoices.table.amount": "المبلغ",
  "subscriptions.invoices.table.status": "الحالة",
  "subscriptions.invoices.table.dueDate": "تاريخ الاستحقاق",
  "subscriptions.invoices.viewInvoice": "عرض الفاتورة",
  "subscriptions.invoices.downloadInvoice": "تنزيل كصورة",
  "status.Paid": "مدفوعة",
  "status.Due": "مستحقة",
  "status.Overdue": "متأخرة",
  "reports.title": "التقارير",
  "reports.tabs.revenue": "تقارير الإيرادات",
  "reports.tabs.subscribers": "تقارير المشتركين",
  "reports.revenue.title": "تقارير الإيرادات",
  "reports.revenue.export": "تصدير",
  "reports.revenue.chartTitle": "نمو MRR و ARR",
  "reports.subscribers.title": "تقارير المشتركين",
  "reports.subscribers.chart1Title": "المشتركون الجدد مقابل المتوقفون (Churn)",
  "reports.subscribers.new": "جدد",
  "reports.subscribers.churned": "متوقفون",
  "reports.subscribers.chart2Title": "معدل التحويل من التجريبي للمدفوع",
  "reports.subscribers.converted": "تحولوا",
  "reports.subscribers.notConverted": "لم يتحولوا",
  "reports.filter.from": "من",
  "reports.filter.to": "إلى",
  "communication.title": "التواصل",
  "communication.tabs.new": "إرسال جديد",
  "communication.tabs.history": "سجل الإشعارات",
  "communication.new.title": "إرسال جديد",
  "communication.new.to": "إلى:",
  "communication.new.target.all": "كل الشركات",
  "communication.new.target.gold": "مشتركي الخطة الذهبية فقط",
  "communication.new.target.trial": "الحسابات التجريبية فقط",
  "communication.new.target.expired": "الحسابات المنتهية",
  "communication.new.subject": "الموضوع:",
  "communication.new.content": "محتوى الرسالة:",
  "communication.new.saveDraft": "حفظ كمسودة",
  "communication.new.schedule": "جدولة الإرسال",
  "communication.new.sendNow": "إرسال الآن",
  "communication.history.table.subject": "الموضوع",
  "communication.history.table.target": "الشريحة المستهدفة",
  "communication.history.table.date": "التاريخ",
  "communication.history.table.status": "الحالة",
  "communication.history.table.actions": "إجراءات",
  "communication.history.actions.view": "عرض الرسالة",
  "communication.history.actions.delete": "حذف الرسالة",
  "communication.history.deleteConfirm": "هل أنت متأكد أنك تريد حذف هذه الرسالة المجدولة؟ لا يمكن التراجع عن هذا الإجراء.",
  "communication.viewModal.title": "تفاصيل الرسالة",
  "communication.history.status.sent": "تم الإرسال",
  "communication.history.status.scheduled": "مجدولة",
  "settings.title": "إعدادات النظام",
  "settings.menu.general": "إعدادات عامة",
  "settings.menu.security": "الأمان والنسخ الاحتياطي",
  "settings.menu.admins": "مدراء النظام",
  "settings.menu.audit": "سجل الأنشطة",
  "settings.general.title": "إعدادات عامة",
  "settings.general.platformName": "اسم المنصة",
  "settings.general.primaryColor": "اللون الأساسي",
  "settings.general.platformLogo": "شعار المنصة",
  "settings.general.removeLogo": "إزالة الشعار",
  "settings.general.smtpHost": "إعدادات SMTP (Host)",
  "settings.general.save": "حفظ التغييرات",
  "settings.security.title": "الأمان والنسخ الاحتياطي",
  "settings.security.schedule": "جدول النسخ الاحتياطي",
  "settings.security.schedule.daily": "يوميًا",
  "settings.security.schedule.weekly": "أسبوعيًا",
  "settings.security.schedule.monthly": "شهريًا",
  "settings.security.backupNow": "أخذ نسخة احتياطية الآن",
  "settings.security.backingUp": "جاري إنشاء النسخة الاحتياطية...",
  "settings.security.backupCompleted": "تم إنشاء النسخة الاحتياطية بنجاح!",
  "settings.security.lastBackup": "آخر نسخة احتياطية",
  "settings.security.noBackup": "لم يتم إنشاء أي نسخة احتياطية بعد.",
  "settings.security.historyTitle": "سجل النسخ الاحتياطي",
  "settings.security.table.id": "معرف النسخة",
  "settings.security.table.date": "التاريخ والوقت",
  "settings.security.table.status": "الحالة",
  "settings.security.table.initiator": "المنشئ",
  "settings.security.table.actions": "إجراءات",
  "settings.security.status.completed": "مكتمل",
  "settings.security.status.failed": "فشل",
  "settings.security.initiator.manual": "يدوي",
  "settings.security.initiator.scheduled": "مجدول",
  "settings.security.actions.download": "تنزيل",
  "settings.security.actions.restore": "استعادة",
  "settings.security.actions.delete": "حذف",
  "settings.security.deleteConfirm": "هل أنت متأكد أنك تريد حذف هذه النسخة الاحتياطية؟",
  "settings.security.restoreConfirm": "هل أنت متأكد أنك تريد الاستعادة من هذه النسخة الاحتياطية؟ لا يمكن التراجع عن هذا الإجراء وقد يؤدي إلى الكتابة فوق البيانات الحالية.",
  "settings.security.restoreSuccess": "تمت الاستعادة بنجاح من النسخة الاحتياطية:",
  "settings.security.restoring": "جاري الاستعادة...",
  "settings.security.pagination.page": "صفحة",
  "settings.security.pagination.of": "من",
  "settings.security.pagination.previous": "السابق",
  "settings.security.pagination.next": "التالي",
  "settings.admins.title": "مدراء النظام",
  "settings.admins.add": "إضافة مشرف جديد",
  "settings.admins.table.name": "الاسم",
  "settings.admins.table.email": "البريد الإلكتروني",
  "settings.admins.table.actions": "إجراءات",
  "settings.admins.modal.addTitle": "إضافة مشرف جديد",
  "settings.admins.modal.namePlaceholder": "مثال: أحمد علي",
  "settings.admins.modal.emailPlaceholder": "مثال: admin3@system.com",
  "settings.admins.deleteConfirm": "هل أنت متأكد أنك تريد حذف هذا المشرف؟",
  "settings.audit.title": "سجل الأنشطة (Audit Log)",
  "settings.audit.table.user": "المستخدم",
  "settings.audit.table.action": "الإجراء",
  "settings.audit.table.timestamp": "الوقت",
  "paymentGateways.title": "إدارة بوابات الدفع",
  "paymentGateways.subtitle": "قم بتوصيل وتفعيل بوابات الدفع الإلكترونية لتلقي اشتراكات عملائك.",
  "paymentGateways.addGateway": "إضافة بوابة جديدة",
  "paymentGateways.manage": "إدارة",
  "paymentGateways.modal.title": "إعدادات",
  "paymentGateways.modal.publishableKey": "المفتاح العام (Publishable Key)",
  "paymentGateways.modal.secretKey": "المفتاح السري (Secret Key)",
  "paymentGateways.modal.environment": "بيئة العمل",
  "paymentGateways.modal.environment.test": "تجريبي (Test)",
  "paymentGateways.modal.environment.live": "فعلي (Live)",
  "paymentGateways.modal.testConnection": "اختبار الاتصال",
  "paymentGateways.modal.connectionSuccess": "تم الاتصال بنجاح",
  "paymentGateways.modal.connectionError": "فشل الاتصال، يرجى مراجعة المفاتيح.",
  "paymentGateways.addModal.title": "إضافة بوابة دفع جديدة",
  "paymentGateways.addModal.name": "اسم البوابة",
  "paymentGateways.addModal.namePlaceholder": "مثال: Visa, Mastercard",
  "paymentGateways.addModal.nameHint": "أدخل اسمًا من مكتبة PaymentFont ليظهر الشعار.",
  "paymentGateways.addModal.description": "الوصف",
  "paymentGateways.addModal.descriptionPlaceholder": "مثال: لقبول بطاقات فيزا حول العالم.",
  "common.save": "حفظ",
  "common.cancel": "إلغاء",
  "common.savePlan": "حفظ الخطة",
  "common.createAndSave": "إنشاء وحفظ",
  "common.month": "شهر",
  "common.year": "سنة",
  "invoice.title": "فاتورة",
  "invoice.billTo": "فاتورة إلى",
  "invoice.invoiceNo": "رقم الفاتورة",
  "invoice.dateIssued": "تاريخ الإصدار",
  "invoice.dueDate": "تاريخ الاستحقاق",
  "invoice.item": "البند",
  "invoice.price": "السعر",
  "invoice.total": "الإجمالي",
  "invoice.status": "الحالة",
  "invoice.thankYou": "شكراً لتعاملكم معنا.",
  "resetPassword.title": "إعادة تعيين كلمة المرور",
  "resetPassword.currentPassword": "كلمة المرور الحالية",
  "resetPassword.newPassword": "كلمة المرور الجديدة",
  "resetPassword.confirmNewPassword": "تأكيد كلمة المرور الجديدة",
  "resetPassword.save": "حفظ التغييرات",
  "resetPassword.cancel": "إلغاء",
  "resetPassword.passwordMismatch": "كلمتا المرور الجديدتان غير متطابقتين.",
  "resetPassword.success": "تم تغيير كلمة المرور بنجاح!",
  "audit.log.tenantCreated": "أنشأ شركة جديدة: {companyName}",
  "audit.log.tenantUpdated": "حدّث بيانات الشركة: {companyName}",
  "audit.log.tenantStatusToggled": "غيّر حالة تفعيل الشركة: {companyName}",
  "audit.log.planCreated": "أنشأ خطة جديدة: {planName}",
  "audit.log.planUpdated": "حدّث الخطة: {planName}",
  "audit.log.planDeleted": "حذف الخطة بمعرّف: {planId}",
  "audit.log.planVisibilityToggled": "غيّر حالة ظهور الخطة: {planName}",
  "audit.log.gatewayToggled": "{action} بوابة الدفع: {gatewayName}",
  "audit.log.gatewaySettingsUpdated": "حدّث إعدادات بوابة الدفع: {gatewayName}",
  "audit.log.gatewayAdded": "أضاف بوابة دفع جديدة: {gatewayName}",
  "audit.log.generalSettingsSaved": "حفظ الإعدادات العامة للنظام",
  "audit.log.backupManual": "بدأ عملية نسخ احتياطي يدوي (المعرّف: {backupId})",
  "audit.log.backupDeleted": "حذف النسخة الاحتياطية: {backupId}",
  "audit.log.backupRestored": "استعاد من النسخة الاحتياطية: {backupId}",
  "audit.log.adminAdded": "أضاف مشرف نظام جديد: {email}",
  "audit.log.adminDeleted": "حذف مشرف النظام بالمعرّف: {adminId}",
  "audit.log.initial.smtpChanged": "قام بتغيير إعدادات SMTP",
  "audit.log.initial.planCreated": "أنشأ خطة جديدة: {planName}",
  "audit.log.initial.accountDeactivated": "قام بتعطيل حساب شركة: {companyName}",
  "audit.log.activated": "فعّل",
  "audit.log.deactivated": "عطّل"
};

const enTranslations = {
  "sidebar.dashboard": "Dashboard",
  "sidebar.tenants": "Tenants Management",
  "sidebar.tenants.all": "All Tenants",
  "sidebar.subscriptions": "Subscriptions & Billing",
  "sidebar.paymentGateways": "Payment Gateways",
  "sidebar.reports": "Reports",
  "sidebar.communication": "Communication",
  "sidebar.settings": "System Settings",
  "sidebar.logout": "Logout",
  "header.superAdmin": "Super Admin",
  "header.changePassword": "Change Password",
  "dashboard.title": "Main Dashboard",
  "dashboard.kpi.mrr": "Monthly Recurring Revenue (MRR)",
  "dashboard.kpi.activeTenants": "Total Active Tenants",
  "dashboard.kpi.newSubscriptions": "New Subscriptions (30 days)",
  "dashboard.kpi.expiringSubscriptions": "Expiring Subscriptions (7 days)",
  "dashboard.revenueGrowth.title": "Revenue Growth (Last 12 months)",
  "dashboard.revenueGrowth.revenue": "Revenue",
  "dashboard.revenueGrowth.profit": "Profit",
  "dashboard.planDistribution.title": "Tenant Distribution by Plan",
  "dashboard.planDistribution.tenants": "Number of Tenants",
  "dashboard.recentCompanies.title": "Last 5 Registered Companies",
  "dashboard.recentPayments.title": "Last 5 Successful Payments",
  "tenants.title": "Tenants Management",
  "tenants.searchPlaceholder": "Search by name or domain...",
  "tenants.filterByPlan": "Filter by Plan",
  "tenants.filterByStatus": "Filter by Status",
  "tenants.table.companyName": "Company Name",
  "tenants.table.subdomain": "Subdomain",
  "tenants.table.currentPlan": "Current Plan",
  "tenants.table.status": "Status",
  "tenants.table.startDate": "Start Date",
  "tenants.table.endDate": "End Date",
  "tenants.table.users": "Users",
  "tenants.table.actions": "Actions",
  "tenants.actions.view": "View Details",
  "tenants.actions.edit": "Edit Tenant",
  "tenants.actions.activate": "Activate Account",
  "tenants.actions.deactivate": "Deactivate Account",
  "tenants.modal.viewTitle": "Tenant Details",
  "tenants.modal.editTitle": "Edit Tenant Details",
  "tenants.modal.close": "Close",
  "tenants.modal.save": "Save Changes",
  "tenants.add.button": "Add New Tenant",
  "tenants.add.title": "Create New Tenant Account",
  "tenants.add.companyNamePlaceholder": "e.g., Acme Corporation",
  "tenants.add.subdomainPlaceholder": "e.g., acme",
  "tenants.add.adminName": "Admin Name",
  "tenants.add.adminNamePlaceholder": "e.g., John Doe",
  "tenants.add.adminEmail": "Admin Email",
  "tenants.add.adminEmailPlaceholder": "e.g., admin@acme.com",
  "tenants.add.password": "Initial Password",
  "tenants.add.generate": "Generate",
  "tenants.add.subdomainTaken": "This subdomain is already taken.",
  "status.Active": "Active",
  "status.Trial": "Trial",
  "status.Expired": "Expired",
  "status.Deactivated": "Deactivated",
  "status.Disabled": "Disabled",
  "status.SetupRequired": "Setup Required",
  "subscriptions.title": "Subscriptions & Billing",
  "subscriptions.tabs.plans": "Pricing Plans",
  "subscriptions.tabs.payments": "Payment History",
  "subscriptions.tabs.invoices": "Invoices",
  "subscriptions.plans.createPlan": "Create New Plan",
  "subscriptions.plans.editPlan": "Edit Plan",
  "subscriptions.plans.deletePlan": "Delete Plan",
  "subscriptions.plans.deleteDisabledTooltip": "Cannot delete plan with active subscribers.",
  "subscriptions.plans.createTitle": "Create a New Plan",
  "subscriptions.plans.editTitle": "Edit Plan",
  "subscriptions.plans.planName": "Plan Name",
  "subscriptions.plans.planType": "Plan Type",
  "subscriptions.plans.type.Trial": "Trial",
  "subscriptions.plans.type.Paid": "Paid",
  "subscriptions.plans.type.Free": "Free",
  "subscriptions.plans.trialDuration": "Trial Duration",
  "subscriptions.plans.days": "days",
  "subscriptions.plans.pricing": "Pricing",
  "subscriptions.plans.priceMonthly": "Monthly Price ($)",
  "subscriptions.plans.priceYearly": "Yearly Price ($)",
  "subscriptions.plans.yearlyDiscount": "e.g., offer 2 months free",
  "subscriptions.plans.resourceLimits": "Resource Limits",
  "subscriptions.plans.maxUsers": "Max Users",
  "subscriptions.plans.unlimited": "Unlimited",
  "subscriptions.plans.maxClients": "Max Clients",
  "subscriptions.plans.clients": "Clients",
  "subscriptions.plans.storageGB": "Storage (GB)",
  "subscriptions.plans.features": "Features List",
  "subscriptions.plans.featuresPlaceholder": "Enter one feature per line...",
  "subscriptions.plans.users": "users",
  "subscriptions.plans.storage": "storage",
  "subscriptions.plans.edit": "Edit",
  "subscriptions.plans.show": "Visible to new users",
  "subscriptions.payments.export": "Export",
  "subscriptions.payments.table.transactionId": "Transaction ID",
  "subscriptions.payments.table.companyName": "Company Name",
  "subscriptions.payments.table.amount": "Amount",
  "subscriptions.payments.table.status": "Status",
  "subscriptions.payments.table.date": "Date",
  "status.Successful": "Successful",
  "status.Failed": "Failed",
  "subscriptions.invoices.table.invoiceNo": "Invoice #",
  "subscriptions.invoices.table.companyName": "Company Name",
  "subscriptions.invoices.table.amount": "Amount",
  "subscriptions.invoices.table.status": "Status",
  "subscriptions.invoices.table.dueDate": "Due Date",
  "subscriptions.invoices.viewInvoice": "View Invoice",
  "subscriptions.invoices.downloadInvoice": "Download as Image",
  "status.Paid": "Paid",
  "status.Due": "Due",
  "status.Overdue": "Overdue",
  "reports.title": "Reports",
  "reports.tabs.revenue": "Revenue Reports",
  "reports.tabs.subscribers": "Subscriber Reports",
  "reports.revenue.title": "Revenue Reports",
  "reports.revenue.export": "Export",
  "reports.revenue.chartTitle": "MRR & ARR Growth",
  "reports.subscribers.title": "Subscriber Reports",
  "reports.subscribers.chart1Title": "New vs. Churned Subscribers",
  "reports.subscribers.new": "New",
  "reports.subscribers.churned": "Churned",
  "reports.subscribers.chart2Title": "Trial to Paid Conversion Rate",
  "reports.subscribers.converted": "Converted",
  "reports.subscribers.notConverted": "Not Converted",
  "reports.filter.from": "From",
  "reports.filter.to": "To",
  "communication.title": "Communication",
  "communication.tabs.new": "New Broadcast",
  "communication.tabs.history": "Notification History",
  "communication.new.title": "New Broadcast",
  "communication.new.to": "To:",
  "communication.new.target.all": "All Companies",
  "communication.new.target.gold": "Gold Plan Subscribers",
  "communication.new.target.trial": "Trial Accounts",
  "communication.new.target.expired": "Expired Accounts",
  "communication.new.subject": "Subject:",
  "communication.new.content": "Message Content:",
  "communication.new.saveDraft": "Save Draft",
  "communication.new.schedule": "Schedule Send",
  "communication.new.sendNow": "Send Now",
  "communication.history.table.subject": "Subject",
  "communication.history.table.target": "Target Audience",
  "communication.history.table.date": "Date",
  "communication.history.table.status": "Status",
  "communication.history.table.actions": "Actions",
  "communication.history.actions.view": "View Broadcast",
  "communication.history.actions.delete": "Delete Broadcast",
  "communication.history.deleteConfirm": "Are you sure you want to delete this scheduled broadcast? This action cannot be undone.",
  "communication.viewModal.title": "Broadcast Details",
  "communication.history.status.sent": "Sent",
  "communication.history.status.scheduled": "Scheduled",
  "settings.title": "System Settings",
  "settings.menu.general": "General Settings",
  "settings.menu.security": "Security & Backups",
  "settings.menu.admins": "Admin Users",
  "settings.menu.audit": "Audit Log",
  "settings.general.title": "General Settings",
  "settings.general.platformName": "Platform Name",
  "settings.general.primaryColor": "Primary Color",
  "settings.general.platformLogo": "Platform Logo",
  "settings.general.removeLogo": "Remove Logo",
  "settings.general.smtpHost": "SMTP Settings (Host)",
  "settings.general.save": "Save Changes",
  "settings.security.title": "Security & Backups",
  "settings.security.schedule": "Backup Schedule",
  "settings.security.schedule.daily": "Daily",
  "settings.security.schedule.weekly": "Weekly",
  "settings.security.schedule.monthly": "Monthly",
  "settings.security.backupNow": "Backup Now",
  "settings.security.backingUp": "Backing up...",
  "settings.security.backupCompleted": "Backup completed successfully!",
  "settings.security.lastBackup": "Last backup",
  "settings.security.noBackup": "No backup has been created yet.",
  "settings.security.historyTitle": "Backup History",
  "settings.security.table.id": "Backup ID",
  "settings.security.table.date": "Date & Time",
  "settings.security.table.status": "Status",
  "settings.security.table.initiator": "Initiator",
  "settings.security.table.actions": "Actions",
  "settings.security.status.completed": "Completed",
  "settings.security.status.failed": "Failed",
  "settings.security.initiator.manual": "Manual",
  "settings.security.initiator.scheduled": "Scheduled",
  "settings.security.actions.download": "Download",
  "settings.security.actions.restore": "Restore",
  "settings.security.actions.delete": "Delete",
  "settings.security.deleteConfirm": "Are you sure you want to delete this backup?",
  "settings.security.restoreConfirm": "Are you sure you want to restore from this backup? This action cannot be undone and may overwrite current data.",
  "settings.security.restoreSuccess": "Successfully restored from backup:",
  "settings.security.restoring": "Restoring...",
  "settings.security.pagination.page": "Page",
  "settings.security.pagination.of": "of",
  "settings.security.pagination.previous": "Previous",
  "settings.security.pagination.next": "Next",
  "settings.admins.title": "Admin Users",
  "settings.admins.add": "Add New Admin",
  "settings.admins.table.name": "Name",
  "settings.admins.table.email": "Email",
  "settings.admins.table.actions": "Actions",
  "settings.admins.modal.addTitle": "Add New Admin",
  "settings.admins.modal.namePlaceholder": "e.g., John Smith",
  "settings.admins.modal.emailPlaceholder": "e.g., admin3@system.com",
  "settings.admins.deleteConfirm": "Are you sure you want to delete this admin user?",
  "settings.audit.title": "Audit Log",
  "settings.audit.table.user": "User",
  "settings.audit.table.action": "Action",
  "settings.audit.table.timestamp": "Timestamp",
  "paymentGateways.title": "Manage Payment Gateways",
  "paymentGateways.subtitle": "Connect and activate electronic payment gateways to receive your customers' subscriptions.",
  "paymentGateways.addGateway": "Add New Gateway",
  "paymentGateways.manage": "Manage",
  "paymentGateways.modal.title": "Settings",
  "paymentGateways.modal.publishableKey": "Publishable Key",
  "paymentGateways.modal.secretKey": "Secret Key",
  "paymentGateways.modal.environment": "Environment",
  "paymentGateways.modal.environment.test": "Test",
  "paymentGateways.modal.environment.live": "Live",
  "paymentGateways.modal.testConnection": "Test Connection",
  "paymentGateways.modal.connectionSuccess": "Connection successful",
  "paymentGateways.modal.connectionError": "Connection failed, please check your keys.",
  "paymentGateways.addModal.title": "Add New Payment Gateway",
  "paymentGateways.addModal.name": "Gateway Name",
  "paymentGateways.addModal.namePlaceholder": "e.g., Visa, Mastercard",
  "paymentGateways.addModal.nameHint": "Enter a name from the PaymentFont library for the logo to appear.",
  "paymentGateways.addModal.description": "Description",
  "paymentGateways.addModal.descriptionPlaceholder": "e.g., Accept Visa cards worldwide.",
  "common.save": "Save",
  "common.cancel": "Cancel",
  "common.savePlan": "Save Plan",
  "common.createAndSave": "Create & Save",
  "common.month": "month",
  "common.year": "year",
  "invoice.title": "INVOICE",
  "invoice.billTo": "Bill To",
  "invoice.invoiceNo": "Invoice #",
  "invoice.dateIssued": "Date Issued",
  "invoice.dueDate": "Due Date",
  "invoice.item": "Item",
  "invoice.price": "Price",
  "invoice.total": "Total",
  "invoice.status": "Status",
  "invoice.thankYou": "Thank you for your business.",
  "resetPassword.title": "Reset Password",
  "resetPassword.currentPassword": "Current Password",
  "resetPassword.newPassword": "New Password",
  "resetPassword.confirmNewPassword": "Confirm New Password",
  "resetPassword.save": "Save Changes",
  "resetPassword.cancel": "Cancel",
  "resetPassword.passwordMismatch": "The new passwords do not match.",
  "resetPassword.success": "Password changed successfully!",
  "audit.log.tenantCreated": "Created new tenant: {companyName}",
  "audit.log.tenantUpdated": "Updated details for tenant: {companyName}",
  "audit.log.tenantStatusToggled": "Toggled activation status for tenant: {companyName}",
  "audit.log.planCreated": "Created new plan: {planName}",
  "audit.log.planUpdated": "Updated plan: {planName}",
  "audit.log.planDeleted": "Deleted plan with ID: {planId}",
  "audit.log.planVisibilityToggled": "Toggled visibility for plan: {planName}",
  "audit.log.gatewayToggled": "{action} gateway: {gatewayName}",
  "audit.log.gatewaySettingsUpdated": "Updated settings for gateway: {gatewayName}",
  "audit.log.gatewayAdded": "Added new payment gateway: {gatewayName}",
  "audit.log.generalSettingsSaved": "Saved general system settings",
  "audit.log.backupManual": "Initiated a manual backup (ID: {backupId})",
  "audit.log.backupDeleted": "Deleted backup: {backupId}",
  "audit.log.backupRestored": "Restored from backup: {backupId}",
  "audit.log.adminAdded": "Added new admin user: {email}",
  "audit.log.adminDeleted": "Deleted admin user with ID: {adminId}",
  "audit.log.initial.smtpChanged": "Changed SMTP settings",
  "audit.log.initial.planCreated": "Created new plan: {planName}",
  "audit.log.initial.accountDeactivated": "Deactivated account for company: {companyName}",
  "audit.log.activated": "Activated",
  "audit.log.deactivated": "Deactivated"
};

type Language = 'en' | 'ar';
type Translations = { [key: string]: any };

interface I18nContextType {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
}

const I18nContext = createContext<I18nContextType | undefined>(undefined);

const loadedTranslations = {
  ar: arTranslations,
  en: enTranslations
};


export const I18nProvider: React.FC<{ children: React.ReactNode }> = ({ children }) => {
  const [language, setLanguage] = useState<Language>(() => {
      const savedLang = localStorage.getItem('language');
      return (savedLang === 'en' || savedLang === 'ar') ? savedLang : 'ar';
  });

  useEffect(() => {
    localStorage.setItem('language', language);
    document.documentElement.lang = language;
    document.documentElement.dir = language === 'ar' ? 'rtl' : 'ltr';
  }, [language]);

  const t = useCallback((key: string): string => {
    const translationsForLang = loadedTranslations[language as keyof typeof loadedTranslations];
    if (!translationsForLang || !translationsForLang[key]) {
      return key; // Return key if translation not found
    }
    return translationsForLang[key];
  }, [language]);


  return (
    <I18nContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </I18nContext.Provider>
  );
};

export const useI18n = (): I18nContextType => {
  const context = useContext(I18nContext);
  if (!context) {
    throw new Error('useI18n must be used within an I18nProvider');
  }
  return context;
};
